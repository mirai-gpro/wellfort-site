---
// ナビゲーション構造
const navItems = [
  { label: 'トップ', href: '/' },
  { label: '事業概要', href: '/#platform' },
  {
    label: 'サービス・商品',
    dropdown: [
      { label: 'Welltect（モニタリングサービス）', href: '/welltect' },
      { label: 'サプリ', href: '/sapuri' },
      { label: '提携クリニック', href: '/teikei' },
      { label: '提携パーソナルジム', href: '/teikei' },
      { label: 'ポイントモール', href: '/pointmall' },
    ]
  },
  { label: '企業情報', href: '/company' },
  { label: 'ニュース', href: '/news' },
  { label: 'お問合せ', href: '/contact' },
];
---

<header class="fixed top-0 left-0 right-0 z-50 bg-tiffany-500/20 backdrop-blur-md border-b border-tiffany-200/30 transition-all duration-300" id="header">
  <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-20">
      <!-- Logo -->
      <a href="/" class="flex items-center space-x-3 group">
        <img
          src="/images/wellfort_logo.png"
          alt="Wellfort Logo"
          class="h-10 w-auto transition-transform duration-300 group-hover:scale-110"
        />
      </a>

      <!-- Desktop Navigation -->
      <div class="hidden lg:flex items-center space-x-1">
        {navItems.map((item) => (
          item.dropdown ? (
            <div class="nav-dropdown relative">
              <button
                type="button"
                class="nav-link px-3 py-2 text-sm font-medium text-white/90 hover:text-tiffany-400 rounded-lg hover:bg-white/10 transition-all duration-200 flex items-center gap-1"
              >
                {item.label}
                <svg class="w-4 h-4 dropdown-arrow transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                </svg>
              </button>
              <div class="dropdown-menu absolute top-full left-0 mt-1 bg-white rounded-xl shadow-lg border border-gray-100 py-2 min-w-[200px] opacity-0 invisible transition-all duration-200">
                {item.dropdown.map((subItem) => (
                  <a
                    href={subItem.href}
                    class="block px-4 py-2 text-sm text-gray-700 hover:bg-tiffany-50 hover:text-tiffany-600 transition-colors"
                  >
                    {subItem.label}
                  </a>
                ))}
              </div>
            </div>
          ) : (
            <a
              href={item.href}
              class="nav-link px-3 py-2 text-sm font-medium text-white/90 hover:text-tiffany-400 rounded-lg hover:bg-white/10 transition-all duration-200"
            >
              {item.label}
            </a>
          )
        ))}
      </div>

      <!-- CTA Button (Desktop) -->
      <div class="hidden lg:block">
        <a href="/online-meeting" class="btn-primary text-sm px-6 py-3">
          無料オンライン面談
        </a>
      </div>

      <!-- Mobile Menu Button -->
      <button
        id="mobile-menu-button"
        class="lg:hidden p-2 rounded-lg hover:bg-tiffany-50 transition-colors"
        aria-label="メニューを開く"
      >
        <svg class="w-6 h-6 text-neutral-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
    </div>
  </nav>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="hidden lg:hidden border-t border-neutral-100 bg-white max-h-[80vh] overflow-y-auto">
    <div class="px-4 py-6 space-y-1">
      {navItems.map((item) => (
        item.dropdown ? (
          <div class="mobile-dropdown">
            <button
              type="button"
              class="mobile-dropdown-btn w-full flex items-center justify-between px-4 py-3 text-base font-medium text-neutral-700 hover:text-tiffany-600 hover:bg-tiffany-50 rounded-lg transition-all"
            >
              {item.label}
              <svg class="w-5 h-5 mobile-dropdown-arrow transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </button>
            <div class="mobile-dropdown-menu hidden pl-4">
              {item.dropdown.map((subItem) => (
                <a
                  href={subItem.href}
                  class="block px-4 py-2 text-sm text-gray-600 hover:text-tiffany-600 hover:bg-tiffany-50 rounded-lg transition-all"
                >
                  {subItem.label}
                </a>
              ))}
            </div>
          </div>
        ) : (
          <a
            href={item.href}
            class="block px-4 py-3 text-base font-medium text-neutral-700 hover:text-tiffany-600 hover:bg-tiffany-50 rounded-lg transition-all"
          >
            {item.label}
          </a>
        )
      ))}
      <div class="pt-4">
        <a href="/online-meeting" class="btn-primary w-full text-center">
          無料オンライン面談
        </a>
      </div>
    </div>
  </div>
</header>

<script>
  // Mobile menu toggle
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');

  mobileMenuButton?.addEventListener('click', () => {
    mobileMenu?.classList.toggle('hidden');
  });

  // Desktop dropdown hover
  document.querySelectorAll('.nav-dropdown').forEach(dropdown => {
    const menu = dropdown.querySelector('.dropdown-menu');
    const arrow = dropdown.querySelector('.dropdown-arrow');

    dropdown.addEventListener('mouseenter', () => {
      menu?.classList.remove('opacity-0', 'invisible');
      menu?.classList.add('opacity-100', 'visible');
      arrow?.classList.add('rotate-180');
    });

    dropdown.addEventListener('mouseleave', () => {
      menu?.classList.add('opacity-0', 'invisible');
      menu?.classList.remove('opacity-100', 'visible');
      arrow?.classList.remove('rotate-180');
    });
  });

  // Mobile dropdown toggle
  document.querySelectorAll('.mobile-dropdown-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const dropdown = btn.closest('.mobile-dropdown');
      const menu = dropdown?.querySelector('.mobile-dropdown-menu');
      const arrow = btn.querySelector('.mobile-dropdown-arrow');

      menu?.classList.toggle('hidden');
      arrow?.classList.toggle('rotate-180');
    });
  });

  // Header scroll effect
  let lastScroll = 0;
  const header = document.getElementById('header');

  window.addEventListener('scroll', () => {
    const currentScroll = window.pageYOffset;

    if (currentScroll > 100) {
      header?.classList.remove('bg-tiffany-500/20', 'border-tiffany-200/30');
      header?.classList.add('bg-white/95', 'border-tiffany-100', 'shadow-soft');
      // Change text colors for nav links
      header?.querySelectorAll('.nav-link').forEach((el) => {
        el.classList.remove('text-white/90');
        el.classList.add('text-neutral-700');
      });
    } else {
      header?.classList.remove('bg-white/95', 'border-tiffany-100', 'shadow-soft');
      header?.classList.add('bg-tiffany-500/20', 'border-tiffany-200/30');
      // Restore white colors
      header?.querySelectorAll('.nav-link').forEach((el) => {
        el.classList.remove('text-neutral-700');
        el.classList.add('text-white/90');
      });
    }

    lastScroll = currentScroll;
  });
</script>

<style>
  #header {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .nav-dropdown:hover .dropdown-menu {
    opacity: 1;
    visibility: visible;
  }

  .dropdown-menu {
    transform-origin: top;
  }
</style>
